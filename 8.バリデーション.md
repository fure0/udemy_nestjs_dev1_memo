# バリデーションとは

- リクエストオブジェクトの形式チェック（例）
  - ユーザー名は1文字以上20文字以内
  - emailはメールアドレスの形式
  - パスワードは英数字で8文字以上

# NestJSでバリデーションを行う方法

- Pipeという機能を使う
  - ハンドラーがリクエストを受け取る前にリクエストに対して処理を行う
  - データの変換とバリデーションが可能
  - 処理を行なった後のデータをハンドラーに渡す
  - Pipeの処理中に例外を返すことも可能

# NestJSの組み込みPipe

- ValidationPipe：入力のバリデーション
- ParseIntPipe：入力を整数型に変換
- ParseBoolPipe：入力をBoolean型に変換
- ParseUUIDPipe：入力をUUID型に変換
- DefaultValuePipe：入力がnull、undefinedの場合にデフォルト値を与える

```bash
# uuid install
npm i uuid
```

# Pipeの適用方法

1. ハンドラへの適用

```typescript
@Post()
@UsePipes(ParseIntPipe)
create(@Body('id') id: number) {
  // ...
}
```

2. パラメータごとに適用

```typescript
@Post()
create(
  @Body('id', ParseIntPipe) id: number,
  @Body('isActive', ParseBoolPipe) isActive: boolean,
) {
  // ...
}
```

3. グローバルへの適用

```typescript
// この場合は、特定のエンドポイントだけに ValidationPipe を適用
@Post()
create(@Body(new ValidationPipe()) dto: CreateUserDto) {
  return this.userService.create(dto);
}
```

```typescript
// アプリ全体のすべてのリクエストに対して Pipe を自動的に適用する という意味
async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  app.useGlobalPipes(new ValidationPipe());
  await app.listen(3000);
}
bootstrap();
```

1. 
```bash
npm i class-validator class-transformer
```